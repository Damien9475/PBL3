import csv

def lire_csv(fichier):
    with open(fichier, mode='r', newline='', encoding='utf-8') as file:
        lecteur_csv = csv.DictReader(file)
        donnees = [ligne for ligne in lecteur_csv]
    return donnees

# Exemple d'utilisation
donnees_athletes = lire_csv('athletes.csv')

def convertir_temps(temps):
    # Supposons que le temps est sous la forme "HH:MM:SS"
    h, m, s = map(int, temps.split(':'))
    return h * 3600 + m * 60 + s

def nettoyer_donnees(donnees):
    for athlete in donnees:
        # Convertir les temps
        athlete['SwimTimeConverted'] = convertir_temps(athlete['SwimTime'])
        athlete['BikeTimeConverted'] = convertir_temps(athlete['BikeTime'])
        athlete['RunTimeConverted'] = convertir_temps(athlete['RunTime'])
        athlete['Transition1TimeConverted'] = convertir_temps(athlete['Transition1Time'])
        athlete['Transition2TimeConverted'] = convertir_temps(athlete['Transition2Time'])

        # GÃ©rer les valeurs manquantes (exemple : remplir avec 0)
        for cle in athlete:
            if athlete[cle] == '':
                athlete[cle] = 0

    return donnees

# Exemple d'utilisation
donnees_nettoyees = nettoyer_donnees(donnees_athletes)

def filtrer_athletes(donnees):
    return [athlete for athlete in donnees if athlete['EventStatus'] == 'Finished']

# Exemple d'utilisation
athletes_filtres = filtrer_athletes(donnees_nettoyees)

